<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>selenium python - My Docs</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="..">My Docs</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="..">Welcome to MkDocs</a>
                            </li>
                            <li >
                                <a href="../bash shell 简单使用/">bash shell 简单使用</a>
                            </li>
                            <li >
                                <a href="../docker/">docker install</a>
                            </li>
                            <li >
                                <a href="../git/">Git</a>
                            </li>
                            <li >
                                <a href="../hello-world/">Hello World</a>
                            </li>
                            <li >
                                <a href="../install jenkins/">install jenkins</a>
                            </li>
                            <li >
                                <a href="../linux  ifcfg eth 配置/">linux ifcfg eth 配置</a>
                            </li>
                            <li >
                                <a href="../linux install mysql/">MySQL Install</a>
                            </li>
                            <li >
                                <a href="../linux 压缩解压类命令/">linux 压缩解压类 命令</a>
                            </li>
                            <li >
                                <a href="../linux 防火墙/">防火墙设置</a>
                            </li>
                            <li class="active">
                                <a href="./">selenium python</a>
                            </li>
                            <li >
                                <a href="../python3随机生成手机号/">python3随机生成手机号</a>
                            </li>
                            <li >
                                <a href="../python3随机生成身份证/">python3随机生成身份证</a>
                            </li>
                            <li >
                                <a href="../python3随机生成银行卡号/">python3随机生成银行卡号</a>
                            </li>
                            <li >
                                <a href="../vim/">vim</a>
                            </li>
                            <li >
                                <a href="../vimium/">vimium</a>
                            </li>
                            <li >
                                <a href="../win apache python wsgi/">windows在apache中使用mod_wsgi部署flask</a>
                            </li>
                            <li >
                                <a href="../windows install mysql/">win10 下 安装 mysql 8</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li >
                                <a rel="next" href="../linux 防火墙/">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li >
                                <a rel="prev" href="../python3随机生成手机号/">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#selenium-python">selenium python</a></li>
            <li><a href="#_1">介绍</a></li>
            <li><a href="#_2">启动</a></li>
            <li><a href="#_3">元素定位</a></li>
        <li class="main "><a href="#_4">通过逻辑运算符定位</a></li>
            <li><a href="#_5">常用函数</a></li>
            <li><a href="#selenium">selenium版本进行降级</a></li>
            <li><a href="#ie">IE报错</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="selenium-python">selenium python</h1>
<h2 id="_1">介绍</h2>
<h2 id="_2">启动</h2>
<pre><code>#!/usr/bin/env python3
# coding:utf-8

import os
import sys

try:
    # 配置目录
    from conf.selenium_config import RESPATH
    os.path.exists(RESPATH)
except:
    # 本机目录，末尾不加 “/”
    RESPATH = 'D:/IDE/Test/res'
    if os.path.exists(RESPATH) is False:
        print(RESPATH, ' is not find')
        quit()

from selenium import webdriver
from selenium.webdriver.common.desired_capabilities import DesiredCapabilities
from selenium.webdriver.firefox.firefox_binary import FirefoxBinary


def chromeDriver():
    driverPath = RESPATH + &quot;/chromedriver2.31.exe&quot;
    # chrome.exe地址
    chromePath = RESPATH + &quot;/Chrome60/chrome.exe&quot;
    # chrome启动选项
    options = webdriver.ChromeOptions()
    # options.add_argument(&quot;--user-data-dir=&quot; + chromeoptionPath))
    options.add_argument(&quot;--start-maximized&quot;)
    options.add_argument(&quot;--test-type&quot;)
    options.add_argument(&quot;allow-running-insecure-content&quot;)
    if os.path.isfile(chromePath):
        options.binary_location = chromePath
    # 带参数启动driver
    dr = webdriver.Chrome(
        chrome_options=options, executable_path=driverPath, port=9515)
    dr.implicitly_wait(10)  # 隐性等待，最长等10秒
    print('driver started')
    return dr


def firefoxDriver():
    # 获取当前文件夹的绝对路径#driver地址
    ffpath = RESPATH + &quot;/Mozilla Firefox46/firefox.exe&quot;
    binary = FirefoxBinary(ffpath)
    # 带参数启动driver
    # profile = webdriver.FirefoxProfile(xx)
    if os.path.isfile(ffpath):
        dr = webdriver.Firefox(firefox_binary=binary)
    else:
        dr = webdriver.Firefox()
    # 将浏览器最大化
    dr.maximize_window()
    # 隐性等待，最长等10秒
    dr.implicitly_wait(10)
    print('driver started')
    return dr


def ieDriver():
    # 修改配置信息
    DesiredCapabilities.INTERNETEXPLORER['ignoreProtectedModeSettings'] = True
    # 获取当前文件夹的绝对路径+driver地址
    driverPath = RESPATH + &quot;/IEDriverServer_x64_2.53.1.exe&quot;
    dr = webdriver.Ie(executable_path=driverPath)
    # 将浏览器最大化
    dr.maximize_window()
    # 隐性等待，最长等10秒
    dr.implicitly_wait(10)
    print('driver started')
    return dr


if __name__ == '__main__':
    # chromeDriver()
    # firefoxDriver()
    ieDriver()
</code></pre>

<h2 id="_3">元素定位</h2>
<p>定位元素先要掌握基本的HTML语法：</p>
<ol>
<li>定位单个元素</li>
</ol>
<p><code>find_element_by_id('selenium')                      #通过id方式定位 
  find_element_by_name('selenium')                    #通过name方式定位 
  find_element_by_class_name('selenium')              #通过class name 方式定位
  find_element_by_tag_name('selenium')                #通过tag name方式定位 
  find_element_by_link_text('selenium')               #通过text方式定位
  find_element_by_partial_link_text('selenium')       #通过部分text方式定位
  find_element_by_xpath('//input[@id="selenium"]')    #通过xpath方式定位
  find_element_by_css_selector('selenium')            #通过CSS方式定位</code></p>
<ol>
<li>定位一组元素,批量对象（复选框）复选框</li>
</ol>
<p><code>find_element_by_id('selenium')                  
  find_element_by_name('selenium')                
  find_element_by_class_name('selenium')          
  find_element_by_tag_name('selenium')            
  find_element_by_link_text('selenium')           
  find_element_by_partial_link_text('selenium')   
  find_element_by_xpath('//input[@id="selenium"]')
  find_element_by_css_selector("[ value='百度一下']")</code></p>
<ol>
<li>相同属性的元素一组对象，取对应的第几个</li>
</ol>
<p><code>find_element_by_id('selenium')[1]                  
  find_element_by_name('selenium')[1]                
  find_element_by_class_name('selenium')[1]          
  find_element_by_tag_name('selenium')[1]            
  find_element_by_link_text('selenium')[1]           
  find_element_by_partial_link_text('selenium')[1]   
  find_element_by_xpath('//input[@id="selenium"]')[1]
  find_element_by_css_selector('selenium')[1]</code></p>
<p><em>注意：()和(-1)都表示最后一个元素</em> <em>xpath语法通过firepath插件可以生成，可以直接使用</em></p>
<ol>
<li>高级 ```</li>
</ol>
<p># 层级与属性结合</p>
<p>find_element_by_xpath("//div[@class='selenium']/input/span") find_element_by_xpath("//div[@class='selenium']/div[2]/input") find_element_by_xpath(.//*[@id='selenium']/../div/div/div[2]/div[4]/button)</p>
<h1 id="_4">通过逻辑运算符定位</h1>
<p>find_element_by_xpath("//input[@id='selenium' and @class='selenium1']/span/input") find_element_by_css_selector("form#form&gt;span&gt;input#su")</p>
<pre><code>1\. 使用starts-with

//div[starts-with(@id,'res')]//table//tr//td[2]//table//tr//td//a//span[contains(.,'Developer Tutorial')]

2\. 使用contains和and

//div[starts-with(@id,'res')]//table[1]//tr//td[2]//a//span[contains(.,'_Test') and contains(.,'KPI')]

3\. 使用descendant

//div[starts-with(@id,'res')]//table[1]//tr//td[2]//a//span[contains(.,'QuickStart')]/../../../descendant::img

4\. 使用ancestor

//div[starts-with(@id,'res')]//table[1]//tr//td[2]//a//span[contains(.,'QuickStart')]/ancestor::div[starts-with(@id,'res')]//table[2]//descendant::a[2]

5\. 使用text()

//span[@id='idHeaderTitleCell' and contains(text(),'QuickStart')]

## 控制

### 浏览器控制  

1\. 控制浏览器大小：
</code></pre>

<p>driver.set_window_size(400,500)<br>
driver.maximize_window() #无参数</p>
<pre><code>浏览器后退、前进：
</code></pre>

<p>driver.back()-后退、 driver.farward()-前进</p>
<pre><code>### 多表单切换（有frame嵌套表单）
</code></pre>

<p>dr.switch_to_frame("frameid")#通过frame的id进入iframe<br>
dr.switch_to_frame("frameName") #通过frame的name进入iframe</p>
<p>framepath=dr.find_element_by_class_name("frameClassname")<br>
dr.switch_to_frame(framepath)#通过frame页面对象进入iframe</p>
<p>dr.switch_to_default_content()#退出当前frame返回上一层</p>
<pre><code>多窗口切换  
selenium-webdriver中使用switch_to_window()方法来切换任意窗口，常用方法有  
driver.current_window_handle    #获取当前窗口句柄  
driver.window_handles            #返回所有窗口句柄到当前会话  
driver.switch_to_window()       #进入窗口，用于切换不同窗口  
dr.title  

警告框处理  
    webdriver中处理js生成的alert、confirm、prompt处理方法是：使用switch_to_alert()定位到alert/confirm/prompt，

alert=dr.switch_to_alert()                    #进入alert  
alert.text #打印对话框里的文字内容  
alert.accept()#对话框里点击alert中确定按钮  
alert.dismiss() #对话框里点击取消按钮  
alert.send_keys(&quot;对话框中输入的内容&quot;) #在对话框里输入内容  

十二、上传文件  
    分2种：普通上传、插件上传  
    普通上传：将本地文件的路径作为一个值放到input标签中，通过form表单提交时，将值传给服务器中去  
    插件上传：指基于flash、javascript或ajax技术实现的上传功能或插件。  
    1.针对普通上传用send_keys实现  
python代码：  

    dr.get(&quot;D:\\workspace\\pySelenium\\resources\\upload.htm&quot;)  
    loadFile=dr.find_element_by_name(&quot;filebutton&quot;)# 获取上传文件input元素节点  
    loadFile.send_keys(&quot;D:\\workspace\\pySelenium\\resources\\frame.htm&quot;)#输入上传文件地址来实现上传  

    2.插件上传:使用AutoIt实现，--需要安装AutoIt程序  
        AutoIt安装，使用暂时略，需要时再追加，流程为：用AutoIt编写上传文件脚本生成exe文件，在python脚本中进行调用  
python代码：  

    loadFile=dr.find_element_by_name(&quot;filebutton&quot;)# 获取上传按钮  
    loadFile.click()    #点击上传按钮，弹出上传对话框  
    os.system(&quot;D:\\autoItFile.exe&quot;)    #调用autoIt生成的exe文件，实现导入  

十三、下载文件:使用AutoIt实现，--需要安装AutoIt程序，方法同上传  
python代码：  

    ffp=webdriver.FirefoxProfile()  
    ffp.set_preference(&quot;browser.download.folderList&quot;,2)#0:代表下载到浏览器默认路径下；2：下载到指定目录  
    ffp.set_preference(&quot;browser.download.manager.showWhenStarting&quot;,False)#是否显示开始：True：显示；False：不显示  
    ffp.set_preference(&quot;browser.download.dir&quot;, os.getcwd())#指定下载文件目录，os.getcwd()无参数，返回当前目录  
    # ffp.set_preference(&quot;browser.helperApps.neverAsk.saveToDisk&quot;,&quot;application/octet-stream&quot;)#下载文件类型，  
    #指定下载页面的content-type值，application/octet-stream为文件类型，http-content-type常用对照表搜索百度  
    dr=webdriver.Firefox(firefox_profile=ffp)  
    dr.get(&quot;https://pypi.python.org/pypi/selenium#downloads&quot;)  
    dr.find_element_by_xpath(&quot;//div[@id='content']/div[3]/table/tbody/tr[3]/td[1]/span/a[1]&quot;).click()  
    #接下来使用autoIt实现  

十四、cookies操作  
    webdriver操作cookies的方法：  
    get_cookies()：获得所有cookies的值  
    get_cookie(name)：获得有特定name值的cookie信息  
    add_cookie(cookie_dict)：添加cookie，必须有name和value  
    delete_cookie(name)：删除特定名称的cookie信息，通过name找到特定的cookie并删除  
    delete_all_cookies()：删除浏览器中所有cookie的信息  
    注意：1.cookie是以字典形式进行存储的；  
    2.使用场景：如登录功能会把用户名写入浏览器cookie指定key为username，那么就可以通过get_cookies()找到username，打印value，找不到说明保存浏览器的cookie是有bug的。  
python代码：  

    num=1  
    dr.get(&quot;http://www.baidu.com&quot;)  
    cookies=dr.get_cookies()#获取cookie的所有信息  
    for ck in cookies:  
    print'----所有cookie',num,':',ck #打印cookie的所有信息  
    num=num+1  
    print'----按name查cookie：',dr.get_cookie(&quot;PSTM&quot;)#通过cookie的name获取cookie信息  
    dr.add_cookie({'name':'hello','value':'123456789'})#向name和value添加会话信息  
    cookies2=dr.get_cookies()#重新获取cookie的所有信息  
    for ck2 in cookies2:  
    if ck2['name']=='hello':  
    print&quot;----加入的cookie信息：%s--&gt;%s&quot;,(ck2['name'],ck2['value'])  

十五、javascript调用，python使用的方法：execute_script()  
python代码：  

    dr.get(&quot;http://www.baidu.com&quot;)  
    dr.find_element_by_id(&quot;kw&quot;).send_keys(&quot;selenium&quot;)  
    dr.find_element_by_id(&quot;su&quot;).click()  
    js=&quot;var q=document.documentElement.scrollTop=1000&quot;    #滚动条滚到最下面  
    dr.execute_script(js)  
    time.sleep(4)  
    js2=&quot;var q=document.documentElement.scrollTop=0&quot;      #滚动条滚到页面顶  
    dr.execute_script(js2)  

十六、截图，适用于脚本出错时，对当前窗口进行截图保存，使用函数：get_screenshot_as_file()  
python代码：  

    dr.get(&quot;http://www.baidu.com&quot;)  
    try:  
    dr.find_element_by_id(&quot;kw1&quot;).send_keys(&quot;selenium&quot;)  
    dr.find_element_by_id(&quot;su&quot;).click()  
    exceptNoSuchElementException,msg:  
    dr.get_screenshot_as_file(&quot;d:\\error.jpg&quot;)    #截图输出到d盘  
    print msg  
    dr.close()  

十七、关闭窗口  
    quit()：退出相关驱动程序并关闭所有窗口。  
    close()：关闭当前窗口，打给多个窗口时，可使用来关闭当前窗口  

## 事件

### 鼠标事件
</code></pre>

<p>ActionChains类提供的常用方法：<br>
1.1 perform()：执行ActionChains中存储的所有行为,对整个事件进行提交<br>
1.2 context_click(): 右击<br>
如：<br>
from selenium.webdriver.common.action_chains import ActionChains<br>
...<br>
ActionChains(dr).context_click(docfile).perform()<br>
1.3 double_click(): 双击<br>
如：<br>
from selenium.webdriver.common.action_chains import ActionChains<br>
...<br>
doubleClick=dr.find_element_by_id("xxx")<br>
ActionChains(dr). double_Click(doubleClick).perform()<br>
1.4 drag_and_drop(source,target): 拖动<br>
如：<br>
from selenium.webdriver.common.action_chains import ActionChains<br>
...<br>
dsource=dr.find_element_by_id("xxx") #拖动的源元素<br>
dtarget=dr.find_element_by_id("xxx") #释放的目标目标元素<br>
ActionChains(dr).drag_and_drop(dsource,dtarget).perform()<br>
1.5 move_to_element(): 鼠标悬停<br>
如：<br>
from selenium.webdriver.common.action_chains import ActionChains<br>
...<br>
above=dr.find_element_by_id("xxx")<br>
ActionChains(dr).move_to_element(above).perform()</p>
<pre><code>### 键盘事件
</code></pre>

<pre><code>from selenium.webdriver.common.keys importKeys  
...  
dr.get(&quot;http://www.baidu.com&quot;)  
#输入内容  
dr.find_element_by_id(&quot;kw&quot;).send_keys(&quot;seleniumm&quot;)  
#删除输入内容的最后一个字母,  
dr.find_element_by_id(&quot;kw&quot;).send_keys(Keys.BACK_SPACE)  
#输入：空格+教程  
dr.find_element_by_id(&quot;kw&quot;).send_keys(Keys.SPACE)  
dr.find_element_by_id(&quot;kw&quot;).send_keys(u&quot;教程&quot;)  
#ctrl+a全选输入框内容  
dr.find_element_by_id(&quot;kw&quot;).send_keys(Keys.CONTROL,'a')  
#ctrl+x剪贴输入框内容  
dr.find_element_by_id(&quot;kw&quot;).send_keys(Keys.CONTROL,'x')  
#ctrl+v剪贴输入框内容  
dr.find_element_by_id(&quot;kw&quot;).send_keys(Keys.CONTROL,'v')  
#回车键操作  
dr.find_element_by_id(&quot;su&quot;).send_keys(Keys.ENTER)  
dr.close()  

常用的键盘操作整理：  
send_keys(Keys.BACK_SPACE)  #删除键BackSpace  
send_keys(Keys.SPACE)       #空格键Space  
send_keys(Keys.TAB)         #制表键Tab  
send_keys(Keys.ESCAPE)      #回退键Esc  
send_keys(Keys.ENTER)       #回车键Enter  
send_keys(Keys.CONTROL,'a') #Ctrl+a  
send_keys(Keys.CONTROL,'c') #Ctrl+c      
send_keys(Keys.CONTROL,'x') #Ctrl+x  
send_keys(Keys.CONTROL,'v') #Ctrl+x  
send_keys(Keys.F1)          #F1,类似的有F1-F12
</code></pre>

<pre><code>## 动作

## 等待

### 显示等待
</code></pre>

<p>WebDriverWait(driver, timeout,poll_frequency,ignored_exceptions=None).until(method,message)<br>
示例：<br>
WebDriverWait(dr,5,0.5,None).until(<br>
expected_conditions.presence_of_element_located((By.ID,"kw1")),message='test')<br>
解释：<br>
A.WebDriverWait()：在设置时间内，默认间隔一段时间检测一次当前页面元素是否存在，若超过当前指定时间检测不到则抛出异常；<br>
B.driver：webdriver的浏览器驱动，ie、firefox、chromea<br>
C.timeout：最长超时时间，以秒为单位<br>
D.poll_frequency：休眠间隔时间-步长，默认0.5秒<br>
E.ignored_exceptions：超时后异常信息，默认抛出NoSuchElementException异常<br>
F.until(method,message): 调用该方法提供的驱动作为一个参数，直到返回值为True<br>
G.until_not(method,message):调用该方法提供的驱动作为一个参数，直到返回值为False<br>
H.expected_conditions类提供的预期条件实现有：<br>
title_is:判断标题是否是xx<br>
title_contains:判断标题是否包含xx<br>
presence_of_element_located：元素是否存在</p>
<pre><code>visibility_of_element_located：元素是否存在  

    visibility_of：是否可见  

    presence_of_all_elements_located：判断一组元素是否存在  

    text_to_be_present_in_element：判断元素是否有xx文本信息    

    text_to_be_present_in_element_value：判断元素值是否有xx文本信息    

    frame_to_be_available_and_switch_to_it：表单是否可见，并切换到该表单  

    invisibility_of_element_located：判断元素是否隐藏  
    element_to_be_clickable：判断元素是否点击，它处于可见和启动状态  
    staleness_of：等到一个元素不再依附于DOM  
    element_to_be_selected：被选中的元素  
    element_located_to_be_selected：一个期望的元素位于被选中  
    element_selection_state_to_be：一个期望检查如果给定元素被选中  
    element_located_selection_state_to_be：期望找到一个元素并检查是否是选择状态  
    alert_is_present：预期一个警告信息
</code></pre>

<pre><code>### 隐式等待:

通过一定的时长等待页面所有元素加载完成，哪个元素超出设置时长没被加载就抛出异常NoSuchElementException，隐式等待是针对所有元素的
</code></pre>

<pre><code>implicitly_wait(5)    #默认单位为秒  
示例：  
    dr.implicitly_wait(5)
</code></pre>

<pre><code>### sleep休眠

python中强制的程序等待
</code></pre>

<pre><code>time.sleep(4)    #默认单位秒，设置小于1秒的时间可以用小数点如sleep(0.6)
</code></pre>

<pre><code>## 问题

### 验证码处理  

    方法1：去掉验证码
    方法2：设置万能验证码
    方法3：使用cookie方法获取，cookie时间延长

### 截屏
</code></pre>

<pre><code>driver.save_screenshot('E:\\pythonScript\\images\\'+time.strftime(&quot;%Y-%m-%d %H:%M:%S&quot;, time.localtime())+'baidu.png')
</code></pre>

<pre><code>## Element取值
</code></pre>

<p>size 获取元素的尺寸<br>
text 获取元素的文本<br>
get_attribute(name) 获取属性值<br>
location 获取元素坐标，先找到要获取的元素，再调用该方法<br>
page_source 返回页面源码<br>
driver.title 返回页面标题<br>
current_url 获取当前页面的URL<br>
is_displayed() 设置该元素是否可见<br>
is_enabled() 判断元素是否被使用<br>
is_selected() 判断元素是否被选中<br>
tag_name 返回元素的tagName ```</p>
<h2 id="_5">常用函数</h2>
<p>1.获取当前页面的Url函数<br>
driver.current_url</p>
<p>2.获取元素坐标<br>
driver.find_element_by_id('selenium').location</p>
<p>3.表单的提交<br>
driver.find_element_by_id('selenium').submit()</p>
<p>4.获取CSS的属性值<br>
driver.find_element_by_css_selector("input.btn").value_of_css_property("input.btn")</p>
<p>5.获取元素的属性值<br>
driver.find_element_by_id('selenium').get_attribute("selenium")</p>
<p>6.判断元素是否被选中<br>
driver.find_element_by_id("form1").is_selected()</p>
<p>7.返回元素的大小<br>
driver.find_element_by_id("iptPassword").size<br>
//返回值：{'width': 250, 'height': 30}</p>
<p>8.判断元素是否显示<br>
driver.find_element_by_id("iptPassword").is_displayed()</p>
<p>9.判断元素是否被使用<br>
driver.find_element_by_id("iptPassword").is_enabled()</p>
<p>10.获取元素的文本值 driver.find_element_by_id("iptUsername").text</p>
<p>11.元素赋值<br>
driver.find_element_by_id("iptUsername").send_keys('admin')</p>
<p>12.返回元素的tagName<br>
driver.find_element_by_id("iptUsername").tag_name</p>
<p>13.删除浏览器所有的cookies<br>
driver.delete_all_cookies()</p>
<p>14.删除指定的cookie<br>
deriver.delete_cookie("my_cookie_name")</p>
<p>15.关闭浏览器<br>
driver.close()</p>
<p>16.关闭浏览器并且推出驱动程序<br>
driver.quit()</p>
<p>17.返回上一页<br>
driver.back()</p>
<p>18.设置等待超时<br>
driver.implicitly_wait(30)</p>
<p>19.浏览器窗口最大化<br>
driver.maximize_window()</p>
<p>20.查看浏览器的名字<br>
drvier.name</p>
<h2 id="selenium">selenium版本进行降级</h2>
<p>降级方法如下：</p>
<p>1)查看当前的selenium版本打开终端，输入 pip show selenium python3 -m pip show selenium python2.7 -m pip show selenium 2）删除当前python下的selenium版本为了避免与之前安装的selenium版本冲突，先找到selenium3.0目录：python\Lib\site-packages目录把里面selenium开头的文件全部删除就可以了。python所有的第三方包都在这个目录下面。selenium相关的目录全部删除。 3）打开终端，输入 pip install selenium==2.53.6 （注意是两个==，中间不要留空格，这里推荐2.53.6的版本） python3 pip install selenium==2.53.6 python2.7 pip install selenium==2.53.6</p>
<h2 id="ie">IE报错</h2>
<p>File "D:\goodgoodstudy\Python35\lib\site-packages\selenium\webdriver\remote\webdriver.py", line 248, in get self.execute(Command.GET, {'url': url}) File "D:\goodgoodstudy\Python35\lib\site-packages\selenium\webdriver\remote\webdriver.py", line 236, in execute self.error_handler.check_response(response) File "D:\goodgoodstudy\Python35\lib\site-packages\selenium\webdriver\remote\errorhandler.py", line 192, in check_response raise exception_class(message, screen, stacktrace) selenium.common.exceptions.WebDriverException: Message: Failed to navigate to <a href="https://www.baidu.com">https://www.baidu.com</a>. This usually means that a call to the COM method IWebBrowser2::Navigate2() failed.</p>
<p>该错误是需要在DCOM组件服务器中给Internet Explorer授权。操作如下： （1）打开开始菜单的运行对话框，输入dcomcnfg命令，确定，这时会弹出组件服务窗口 （2）展开计算机-〉我的电脑-〉DCOM配置，找到Internet Explorer应用程序节点 （3）单击右键-〉属性，选中"安全"选项，在下面三个项目都选择"自定义"，并单击编辑按钮 （4）在启动权限对话框中查看用户权限，全部给到最大权限。 （5） 选择"身份标识",再选择"交互式用户"即可</p>
<p>以上完美解决了能打开浏览器但是一直不能获取到地址的问题。 from selenium.webdriver.common.desired_capabilities import DesiredCapabilities DesiredCapabilities.INTERNETEXPLORER['ignoreProtectedModeSettings'] = True</p>
<p>System.setProperty("webdriver.chrome.driver", "files/chromedriver.exe"); ChromeOptions options = new ChromeOptions(); options.setBinary("C:/Chrome/Application/chrome.exe"); ChromeDriver driver = new ChromeDriver(options);</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
